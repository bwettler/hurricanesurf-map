<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hurricane Surf Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map {
      height: 600px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>Hurricane Surf Events</h1>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([37.8, -96], 4);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // This function creates your SVG hurricane icon and scales it with zoom
    function createIcon(zoom) {
      const size = Math.max(16, zoom * 2);
      const svg = `
        <svg width="${size}" height="${size}" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="32" r="30" fill="#0077be" stroke="#fff" stroke-width="4"/>
          <path d="M32 12 C42 12, 52 22, 52 32 C52 42, 42 52, 32 52 C22 52, 12 42, 12 32 C12 22, 22 12, 32 12 Z" fill="#fff"/>
        </svg>
      `;
      return L.divIcon({
        html: svg,
        className: '',
        iconSize: [size, size],
        iconAnchor: [size / 2, size / 2]
      });
    }

    let geojsonLayer;

    // Load your GeoJSON file and place SVG markers
    fetch('surf-locations.geojson')
      .then(response => response.json())
      .then(data => {
        geojsonLayer = L.geoJSON(data, {
          pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {
              icon: createIcon(map.getZoom())
            }).bindPopup(`
              <strong>${feature.properties.location}</strong><br>
              Hurricane: ${feature.properties.hurricane} (${feature.properties.year})<br>
              Surf: ${feature.properties.surf}<br>
              Notes: ${feature.properties.notes}<br>
              <a href="${feature.properties.link}" target="_blank" rel="noopener noreferrer">View Surf Media</a>
            `);
          }
        }).addTo(map);
      });

    // Update icon size when zoom changes
    map.on('zoomend', () => {
      const newZoom = map.getZoom();
      geojsonLayer.eachLayer(layer => {
        const latlng = layer.getLatLng();
        const popup = layer.getPopup();
        layer.setIcon(createIcon(newZoom));
        if (popup && popup.isOpen()) {
          layer.bindPopup(popup.getContent());
        }
      });
    });
  </script>
</body>
</html>
